# RESTful API

针对以网络为基础的应用软件的架构设计，REST 指的是一组架构约束条件和原则。如果符合 REST 的约束条件和原则，就称为 RESTful 架构。RESTful 背后的理念就是使用 Web 的现有特征和能力，更好地使用现有 Web 标准中的一些准则和约束。

资源是 Web 架构的关键点，需要三个操作：用 URI 识别资源，表示资源 (HTML 等)，通过协议 (HTTP 等) 与资源交互。

## 1. 资源与 URI

常用规则：
- 使用名词而不是动词，推荐用复数
- 用 _ 或 - 让 URI 可读性更好
- 用 / 表示资源的层级关系
- 用 ? 过滤资源
- 用 , 或 ; 表示同级资源的关系

## 2. 统一资源接口

统一接口包含了一组受限的预定义的操作。
- GET 和 HEAD 是安全的
- GET、HEAD、PUT 和 DELETE 是幂等的
- POST 不安全且不幂等

## 3. 资源的表述

资源的具体呈现可以有多种表示形式，在客户端和服务端之间传送的是资源的表述，而不是资源本身。
- 比如文本资源有 html、xml、json 等格式，图片有 png 或 jpg 格式。

客户端如何知道服务端提供哪种表述形式呢?
- 通过 HTTP 内容协商，客户端可以通过 Accept 头请求一种特定格式的表述，服务端则通过 Content-Type 告诉客户端资源的表述形式。

实践上常见的设计:
- 在 URI 中带上版本号
- 使用 URI 后缀来区分表述格式

## 4. 资源的链接

浏览 Web 网页时，从一个链接跳到一个页面，再从另一个链接跳到另外一个页面，就是利用了超媒体的概念：把一个个资源链接起来。要达到这个目的，就要求在表述格式里加入链接来引导客户端。即使用超媒体来增强资源的连通性。
- 比如在响应头里增加 Link 头告诉客户端怎么访问下一页和最后一页的记录。

## 5. 状态的转移

无状态通信原则，并不是说客户端应用不能有状态，而是指服务端不应该保存客户端状态。

### 应用状态与资源状态

- 状态应该区分应用状态和资源状态，客户端负责维护应用状态，而服务端维护资源状态。
- 客户端与服务端的交互必须是无状态的，并在每一次请求中包含处理该请求所需的一切信息。
- 服务端不需要在请求间保留应用状态，只有在接受到实际请求的时候，服务端才会关注应用状态。
- 这种无状态通信原则，使得服务端和中介能够理解独立的请求和响应。
- 在多次请求中，同一客户端也不再需要依赖于同一服务器，方便实现高可扩展和高可用性的服务端。

### 应用状态的转移

- “会话”状态不是作为资源状态保存在服务端的，而是被客户端作为应用状态进行跟踪的。
- 客户端应用状态在服务端提供的超媒体的指引下发生变迁。
- 服务端通过超媒体告诉客户端当前状态有哪些后续状态可以进入。

## Reference

- http://www.runoob.com/w3cnote/restful-architecture.html
- https://www.zhihu.com/question/28557115